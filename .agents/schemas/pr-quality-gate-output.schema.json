{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/rjmurillo/ai-agents/schemas/pr-quality-gate-output.schema.json",
  "title": "PR Quality Gate Output",
  "description": "Standardized output format for PR quality gate agents (security, QA, analyst, architect, DevOps, roadmap)",
  "type": "object",
  "required": ["verdict", "message", "agent", "timestamp", "findings"],
  "additionalProperties": false,
  "properties": {
    "verdict": {
      "type": "string",
      "enum": ["PASS", "WARN", "CRITICAL_FAIL"],
      "description": "Overall quality gate result"
    },
    "message": {
      "type": "string",
      "description": "One-sentence summary of the review outcome",
      "minLength": 1
    },
    "agent": {
      "type": "string",
      "enum": ["security", "qa", "analyst", "architect", "devops", "roadmap"],
      "description": "Which quality gate agent produced this output"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when the review was performed"
    },
    "findings": {
      "type": "array",
      "description": "List of findings from the review",
      "items": {
        "$ref": "#/$defs/finding"
      }
    }
  },
  "$defs": {
    "finding": {
      "type": "object",
      "required": ["severity", "category", "description"],
      "additionalProperties": false,
      "properties": {
        "severity": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "description": "Finding severity level"
        },
        "category": {
          "type": "string",
          "description": "Finding category (e.g., injection, architecture, test-coverage)",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "What was found",
          "minLength": 1
        },
        "location": {
          "type": "string",
          "description": "File path and optional line number (e.g., src/app.py:42)"
        },
        "cwe": {
          "type": "string",
          "pattern": "^CWE-[0-9]+$",
          "description": "CWE identifier if applicable (security findings)"
        },
        "recommendation": {
          "type": "string",
          "description": "Suggested remediation"
        }
      }
    }
  }
}
